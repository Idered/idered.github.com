<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">

	<!-- @see developer.mozilla.org/en-US/docs/Controlling_DNS_prefetching -->
	<link rel="dns-prefetch" href="//p.twitter.com">
	<link rel="dns-prefetch" href="//cdn.api.twitter.com">
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//platform.twitter.com">

	<title>The correct way to handle pre tag</title>

	<link rel="stylesheet" href="/ui/style.css">

	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,800' rel='stylesheet' type='text/css'>

	<link rel="shortcut icon" href="/favicon.gif">
    <link rel="apple-touch-icon-precomposed" href="/favicon.gif">
    <meta name="apple-mobile-web-app-title" content="csswizardry">
    <meta name="description" content="">

	<!-- @see codular.com/google-author-image -->
	<link rel="author" href="https://plus.google.com/116964578938339291040/posts">

	<!-- @see ogp.me -->
	<meta property="og:title" content="The correct way to handle pre tag" />
	<meta property="og:type" content="website" />
	<meta property="og:description" content="" />
	<meta property="og:url" content="/2012/07/the-correct-way-to-handle-pre-tag">

	<!-- @see dev.twitter.com/docs/cards -->
	<meta property="twitter:title" content="The correct way to handle pre tag">
	<meta property="twitter:creator" content="@Idered">
	<meta property="twitter:card" content="summary">
	<meta property="twitter:description" content="">
	<meta property="twitter:url" content="/2012/07/the-correct-way-to-handle-pre-tag">
</head>
<body class="page--post">


<div class="main wrapper">

	<aside class="sidebar">

		<a href="/" rel="index" class="site-name fx--opacity">
			Kasper.<span>Mikiewicz</span>
		</a>
		<!-- /.site-name -->

		<ul class="nav nav--stacked site-nav">
			<li class="site-nav__about"><a href="/about-me">About me</a></li>
			<li class="site-nav__projects"><a href="/projects">Projects</a></li>
			<li class="site-nav__contact"><a href="/contact">Contact</a></li>
		</ul>
		<!-- /.nav.site-nav -->

		<p class="sidebar__about-me">Hello, I’m Kasper. I’m 21 years old <b>designer</b>, <b>developer</b> and <b>writer</b> from Poland. I like to <a href="http://twitter.com/Idered">tweet</a>, <a href="http://idered.pl/archive">write</a>, <a href="http://dribbble.com/Idered">design</a> and <a href="http://github.com/Idered">share my code</a>.</p>

		<p class="footer">
			2013 &copy; <a href="http://twitter.com/Idered">Kasper Mikiewicz</a>.
		</p>

	</aside>
	<!-- /.sidebar -->

	<div class="content">
		<article class="post">

    <h1 class="post__title">The correct way to handle pre tag</h1>

    <p>There are two things that we have to remember when we want embed some code on our website: <strong>it should be highlighted</strong> and <strong>easy to copy</strong>.</p>

<h3>Adding code</h3>

<p>To add code, we'll use this structure:</p>

<pre><code>&lt;pre class="prettyprint"&gt;&lt;code&gt;...&lt;/code&gt;&lt;/pre&gt;
</code></pre>

<h3>Code highlighting</h3>

<p>This is easy, we can use <a href="http://code.google.com/p/google-code-prettify/">Google Code Prettify</a>, it's easy to setup and quite universal. We just have to add some CSS and JavaScript, it's all well described <a href="http://google-code-prettify.googlecode.com/svn/trunk/README.html">here</a>.</p>

<h3>Adding "copy" functionality</h3>

<p>The idea is simple:</p>

<blockquote><p>When user clicks on code then it is replaced with textarea where the code itself is added and selected. When the textarea loses focus, it is reverted to original state.</p></blockquote>

<p>To accomplish this, we'll use <a href="http://jquery.com">jQuery</a>. Okey, now let's write some JavaScript.</p>

<pre><code>$("pre").delegate("code", "click", function() {
    // Code
});
</code></pre>

<p><code>Each time we click on code tag that is in pre tag, the function is called</code></p>

<pre><code>var $code = $(this),
    $pre  = $(this).parent(),
    $clone= $code.clone(),
    text  = $code.text(),
    height= $code.outerHeight();
</code></pre>

<p><code>Now we're just setting some variables</code></p>

<pre><code>$code.replaceWith($('&lt;textarea/&gt;'));

var $textarea = $pre.children('textarea');
</code></pre>

<p><code>We're replacing code tag with textarea and add it to variable</code></p>

<pre><code>$textarea.height(height).val(text).select();
</code></pre>

<p><code>We're setting height for textarea as it was for code tag, add text and select it.</code></p>

<pre><code>$textarea.one('blur', function() {
  $textarea.replaceWith($clone);
});
</code></pre>

<p><code>When textarea loses it focus, everything is reverted back</code></p>

<p>At the end, code will look like this:</p>

<pre><code>$("pre").delegate("code", "click", function() {
    var $code = $(this),
        $pre  = $(this).parent(),
        $clone= $code.clone(),
        text  = $code.text(),
        height= $code.outerHeight();

    $code.replaceWith($('&lt;textarea/&gt;'));

    var $textarea = $pre.children('textarea');

    $textarea.height(height).val(text).select();
    $textarea.one('blur', function() {
        $textarea.replaceWith($clone);
    });
});
</code></pre>

<p>And that's all, with this code you can add really great user experience. I've used this technique on this blog so you can test it as you read this post.</p>


</article>
	</div>
	<!-- /.content -->

</div>
<!-- /.main  -->

<script>
	var scripts = {
		'twitter-wjs'   : '//platform.twitter.com/widgets.js',
		'analytics'     : ('https:'==location.protocol?'//ssl':'//www') + '.google-analytics.com/ga.js'
	}, script, _gaq=[['_setAccount','UA-18366146-6'],['_trackPageview']];

	for (var id in scripts) {
		script = document.createElement('script'); script.src = scripts[id];
		script.id = id;script.type = 'text/javascript'; script.async = true;
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(script);
	}
</script>
<script src="/ui/js/jquery.js"></script>
<script src="/ui/js/plugins.js"></script>
<script src="/ui/js/script.js"></script>
</body>
</html>